<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'">
    <link href="./styles.css" rel="stylesheet">
    <title>Jiminy Settings</title>
  </head>
  <body class="bg-zinc-50 dark:bg-zinc-900 text-zinc-700 dark:text-zinc-300 font-sans">
    <main class="p-6 space-y-5">
      <!-- Header -->
      <header>
        <h1 class="text-2xl font-bold tracking-tight text-zinc-900 dark:text-white">Jiminy</h1>
        <p class="text-sm text-zinc-500 dark:text-zinc-400 mt-1">Menu bar app shell</p>
      </header>

      <!-- Settings Card -->
      <section class="bg-white dark:bg-zinc-800 rounded-xl shadow-lg border border-zinc-200 dark:border-zinc-700 p-5 space-y-5">
        <h2 class="text-base font-semibold text-zinc-900 dark:text-white">Settings</h2>

        <!-- Context Folder Path -->
        <div class="space-y-2">
          <label for="context-folder-path" class="block text-sm font-medium text-zinc-700 dark:text-zinc-300">Context Folder Path</label>
          <div class="flex gap-2 items-center">
            <input
              id="context-folder-path"
              type="text"
              placeholder="No folder selected"
              readonly
              class="flex-1 px-3 py-2 text-sm bg-zinc-100 dark:bg-zinc-700/50 border border-zinc-300 dark:border-zinc-600 rounded-lg text-zinc-700 dark:text-zinc-300 placeholder-zinc-400 dark:placeholder-zinc-500 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-transparent read-only:text-zinc-500 dark:read-only:text-zinc-400"
            >
            <button id="context-folder-choose" type="button" class="px-3 py-2 text-sm font-medium bg-zinc-100 dark:bg-zinc-700 border border-zinc-300 dark:border-zinc-600 rounded-lg text-zinc-700 dark:text-zinc-300 hover:bg-zinc-200 dark:hover:bg-zinc-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed">Choose...</button>
          </div>
          <p id="context-folder-error" class="text-xs text-red-600 dark:text-red-400 hidden" role="alert" aria-live="polite"></p>
          <span id="context-folder-status" class="text-xs text-emerald-600 dark:text-emerald-400 hidden" aria-live="polite"></span>
        </div>

        <!-- Advanced Options Toggle -->
        <div class="pt-1">
          <button id="advanced-toggle-btn" type="button" class="flex items-center gap-1.5 text-xs text-zinc-500 dark:text-zinc-400 hover:text-zinc-700 dark:hover:text-zinc-200 transition-colors cursor-pointer">
            <span id="toggle-arrow" class="text-[10px] transition-transform duration-150">â–¶</span>
            Advanced options
          </button>
        </div>

        <!-- Advanced Options -->
        <div id="advanced-options" class="pl-4 border-l-2 border-zinc-200 dark:border-zinc-600 ml-1 space-y-4 hidden">
          <!-- Hotkeys -->
          <div class="space-y-3">
            <label class="block text-sm font-medium text-zinc-700 dark:text-zinc-300">Keyboard Shortcuts</label>
            <p class="text-xs text-zinc-500 dark:text-zinc-400">Click a field and press your desired key combination.</p>

            <div class="space-y-2">
              <div class="flex gap-2 items-center">
                <label for="capture-hotkey" class="text-xs text-zinc-600 dark:text-zinc-400 w-28">Screen Capture:</label>
                <button
                  id="capture-hotkey"
                  type="button"
                  class="hotkey-recorder flex-1 px-2 py-1.5 text-xs bg-zinc-100 dark:bg-zinc-700/50 border border-zinc-300 dark:border-zinc-600 rounded-md text-zinc-700 dark:text-zinc-300 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-transparent font-mono text-left cursor-pointer hover:bg-zinc-200 dark:hover:bg-zinc-600 transition-colors"
                  data-hotkey=""
                >Click to set...</button>
              </div>
              <div class="flex gap-2 items-center">
                <label for="clipboard-hotkey" class="text-xs text-zinc-600 dark:text-zinc-400 w-28">Clipboard Copy:</label>
                <button
                  id="clipboard-hotkey"
                  type="button"
                  class="hotkey-recorder flex-1 px-2 py-1.5 text-xs bg-zinc-100 dark:bg-zinc-700/50 border border-zinc-300 dark:border-zinc-600 rounded-md text-zinc-700 dark:text-zinc-300 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-transparent font-mono text-left cursor-pointer hover:bg-zinc-200 dark:hover:bg-zinc-600 transition-colors"
                  data-hotkey=""
                >Click to set...</button>
              </div>
            </div>
            <div class="flex gap-2 items-center">
              <button id="hotkeys-save" type="button" class="px-3 py-1.5 text-xs font-medium bg-blue-600 hover:bg-blue-700 border border-blue-600 hover:border-blue-700 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-zinc-800 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed">Save Hotkeys</button>
              <button id="hotkeys-reset" type="button" class="px-3 py-1.5 text-xs font-medium bg-zinc-100 dark:bg-zinc-700 border border-zinc-300 dark:border-zinc-600 rounded-md text-zinc-700 dark:text-zinc-300 hover:bg-zinc-200 dark:hover:bg-zinc-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors cursor-pointer">Reset to Defaults</button>
              <span id="hotkeys-status" class="text-xs text-emerald-600 dark:text-emerald-400 hidden" aria-live="polite"></span>
            </div>
            <p id="hotkeys-error" class="text-xs text-red-600 dark:text-red-400 hidden" role="alert" aria-live="polite"></p>
          </div>

          <!-- Exclusions -->
          <div class="space-y-2 pt-2 border-t border-zinc-200 dark:border-zinc-700">
            <label class="block text-sm font-medium text-zinc-700 dark:text-zinc-300">Excluded Paths</label>
            <p class="text-xs text-zinc-500 dark:text-zinc-400">These files and folders will be skipped during sync.</p>
            <ul id="exclusions-list" class="space-y-1 empty:hidden"></ul>
            <button id="add-exclusion" type="button" class="px-3 py-2 text-sm font-medium bg-zinc-100 dark:bg-zinc-700 border border-zinc-300 dark:border-zinc-600 rounded-lg text-zinc-700 dark:text-zinc-300 hover:bg-zinc-200 dark:hover:bg-zinc-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed">Add exclusion...</button>
          </div>
        </div>

        <!-- LLM Provider -->
        <div class="space-y-2">
          <label for="llm-provider" class="block text-sm font-medium text-zinc-700 dark:text-zinc-300">LLM Provider</label>
          <select id="llm-provider" class="w-full px-3 py-2 text-sm bg-zinc-100 dark:bg-zinc-700/50 border border-zinc-300 dark:border-zinc-600 rounded-lg text-zinc-700 dark:text-zinc-300 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-transparent cursor-pointer">
            <option value="">Select provider...</option>
            <option value="gemini">Gemini</option>
            <option value="openai">OpenAI</option>
            <option value="anthropic">Anthropic</option>
          </select>
          <p id="llm-provider-error" class="text-xs text-red-600 dark:text-red-400 hidden" role="alert" aria-live="polite"></p>
        </div>

        <!-- LLM API Key -->
        <div class="space-y-2">
          <label for="llm-api-key" class="block text-sm font-medium text-zinc-700 dark:text-zinc-300">Configure LLM Key</label>
          <div class="flex gap-2 items-center">
            <input
              id="llm-api-key"
              type="password"
              placeholder="Not set"
              autocomplete="off"
              class="flex-1 px-3 py-2 text-sm bg-zinc-100 dark:bg-zinc-700/50 border border-zinc-300 dark:border-zinc-600 rounded-lg text-zinc-700 dark:text-zinc-300 placeholder-zinc-400 dark:placeholder-zinc-500 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-transparent"
            >
            <button id="llm-api-key-save" type="button" class="px-3 py-2 text-sm font-medium bg-blue-600 hover:bg-blue-700 border border-blue-600 hover:border-blue-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-zinc-800 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed">Save</button>
          </div>
          <p id="llm-api-key-error" class="text-xs text-red-600 dark:text-red-400 hidden" role="alert" aria-live="polite"></p>
          <span id="llm-api-key-status" class="text-xs text-emerald-600 dark:text-emerald-400 hidden" aria-live="polite"></span>
        </div>

        <!-- Context Graph -->
        <div class="space-y-2">
          <label class="block text-sm font-medium text-zinc-700 dark:text-zinc-300">Context Graph</label>
          <p id="context-graph-stats" class="text-xs text-zinc-500 dark:text-zinc-400" aria-live="polite"></p>
          <div class="flex gap-2 items-center">
            <button id="context-graph-sync" type="button" class="px-3 py-2 text-sm font-medium bg-zinc-100 dark:bg-zinc-700 border border-zinc-300 dark:border-zinc-600 rounded-lg text-zinc-700 dark:text-zinc-300 hover:bg-zinc-200 dark:hover:bg-zinc-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed">Sync now</button>
            <span id="context-graph-status" class="text-xs text-emerald-600 dark:text-emerald-400 hidden" aria-live="polite"></span>
          </div>
          <div class="flex gap-2 items-center">
            <button id="context-graph-prune" type="button" class="px-3 py-2 text-sm font-medium bg-red-50 dark:bg-red-900/30 border border-red-300 dark:border-red-700 rounded-lg text-red-700 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/50 focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed">Prune Context (Current Path)</button>
            <span id="context-graph-prune-status" class="text-xs text-emerald-600 dark:text-emerald-400 hidden" aria-live="polite"></span>
          </div>
          <p id="context-graph-warning" class="text-xs text-amber-600 dark:text-amber-400 hidden" aria-live="polite"></p>
          <p id="context-graph-progress" class="text-xs text-zinc-500 dark:text-zinc-400" aria-live="polite"></p>
          <p id="context-graph-error" class="text-xs text-red-600 dark:text-red-400 hidden" role="alert" aria-live="polite"></p>
        </div>
      </section>

      <!-- Footer Hint -->
      <p class="text-xs text-zinc-500 dark:text-zinc-400">Open this window anytime from the menu bar icon.</p>
    </main>

    <!-- You can also require other files to run in this process -->
    <script src="./settings-renderer.js"></script>
  </body>
</html>
